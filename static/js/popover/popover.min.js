angular.module("myapp",["angular-storage","ismobile","angularModalService"]).service("toggleServices",function(){this.Data={showSettings:!0},this.getAll=function(){return this.Data},this.setSettings=function(e){this.Data.showSettings=e}}).controller("MyController",["$scope","$timeout","toggleServices","store","isMobile","ModalService","$location",function(e,t,n,i,o,s,a){function l(e,t){return e>=t}var r=MODAL_SIZE,c=a.host();o.phone&&(r="lg");var u=i.get("cso");e.Data=n.getAll(),e.isOpen=function(){n.setSettings(!1)},e.isClosed=function(){n.setSettings(!0)};var p=SHOW_MODAL_TIMEOUT,d=MOUSE_LEAVE,g="/popover.html",m=new Date;"preview.appernetic.io"==c&&(g="/preview/popover.html"),e.open=function(e){s.showModal({templateUrl:g,controller:"ModalInstanceCtrl",inputs:{modalSize:r}}).then(function(e){e.element.modal()})},u?l(m.getTime(),u.date)&&0==u.subscribed&&ENABLE_POPOVER&&(e.Data.showSettings&&t(function(){e.open(r),e.isOpen()},p),e.MouseLeave=function(t){e.isOpen(),d&&1==e.Data.showSettings&&e.open(r)}):ENABLE_POPOVER&&(e.Data.showSettings&&t(function(){e.isOpen(),t(function(){e.open(r)},1e3)},p),e.MouseLeave=function(n){e.isOpen(),d&&1==e.Data.showSettings&&t(function(){e.open(r)},1e3)})}]).controller("ModalInstanceCtrl",["$scope","$http","$timeout","toggleServices","store","isMobile","$element","modalSize","close",function(e,t,n,i,o,s,a,l,r){e.Data=i.getAll(),e.expireCookie=EXPIRE_COOKIE,e.signupheader=SIGNUP_HEADER,e.signuptext=SIGNUP_TEXT,e.inputplaceholder=INPUT_PLACEHOLDER,e.submitbutton=SUBMIT_BUTTON,e.headerimage=HEADER_IMAGE,e.imgdescription=IMG_DESCRIPTION,e.result="",e.isPhone=!1,e.modalSize=l,e.optin=OPTIN,s.phone&&(e.isPhone=!0),e.isOpen=function(){i.setSettings(!0)},e.isClosed=function(){i.setSettings(!1)},e.isOpen(),e.myForm={},e.myForm.Email="",Date.prototype.addDays=function(e){return this.setDate(this.getDate()+parseInt(e)),this};var c=new Date;c.addDays(e.expireCookie);var u={};e.myForm.getFormFieldCssClass=function(e){return e.$pristine?"":e.$valid?"fieldValid":"fieldInvalid"},e.ok=function(){if(e.formNg.$valid){var i={method:"POST",url:POST_URL,headers:{"Content-Type":void 0},data:{email:e.myForm.Email,optin:e.optin}},o=t(i);o.success(function(t,i,o,s){e.SuccessMessage=SUCCESS_MESSAGE,n(function(){e.SuccessMessage="",e.isOpen=!1,e.close()},2e3)}),o.error(function(t,i,o,s){alert("Submitting form failed!"),n(function(){e.ErrorMessage=ERROR_MESSAGE,e.isOpen=!1,e.close()},3e3)})}},e.close=function(){a.modal("hide"),u={date:c.getTime(),subscribed:!0},o.set("cso",u),r(null,500)},e.cancel=function(){u={date:c.getTime(),subscribed:!1},o.set("cso",u),e.isOpen=!1,a.modal("hide"),r(null,500)}}]);